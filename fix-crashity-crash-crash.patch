From 0b71e3d369d1b922541c0f0fe764e576b54a8f1d Mon Sep 17 00:00:00 2001
From: Colin Walters <walters@verbum.org>
Date: Tue, 22 Feb 2011 14:57:58 -0500
Subject: [PATCH] manager: Handle session name being NULL from gdm

https://bugzilla.gnome.org/show_bug.cgi?id=642988
---
 gnome-session/gsm-manager.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/gnome-session/gsm-manager.c b/gnome-session/gsm-manager.c
index a021996..fe8e19e 100644
--- a/gnome-session/gsm-manager.c
+++ b/gnome-session/gsm-manager.c
@@ -1267,7 +1267,7 @@ static void
 possibly_show_fallback_dialog (GsmManager *manager)
 {
         if (manager->priv->is_fallback_session &&
-            strcmp (manager->priv->session_name, "gnome-fallback") == 0 &&
+            g_strcmp0 (manager->priv->session_name, "gnome-fallback") == 0 &&
             g_settings_get_boolean (manager->priv->settings,
                                     KEY_SHOW_FALLBACK_WARNING)) {
                 show_fallback_dialog (_("GNOME 3 Failed to Load"),
@@ -1277,7 +1277,7 @@ possibly_show_fallback_dialog (GsmManager *manager)
                                       "http://www.gnome3.org");
                 g_settings_set_boolean (manager->priv->settings,
                                         KEY_SHOW_FALLBACK_WARNING, FALSE);
-        } else if (strcmp (manager->priv->session_name, "gnome") == 0 &&
+        } else if (g_strcmp0 (manager->priv->session_name, "gnome") == 0 &&
                    g_settings_get_boolean (manager->priv->settings,
                                            KEY_SHOW_FALLBACK_WARNING)) {
                 /* Reset the setting if we ever manage to log into gnome 3 */
-- 
1.7.4.1

